BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 265768244.206908
 ALGERIA                   |   1997 | 454837638.349908
 ALGERIA                   |   1996 | 456756760.482677
 ALGERIA                   |   1995 | 456066277.205472
 ALGERIA                   |   1994 | 452145899.004825
 ALGERIA                   |   1993 | 455776401.672291
 ALGERIA                   |   1992 | 448690180.473045
 ARGENTINA                 |   1998 |   269503122.9815
 ARGENTINA                 |   1997 | 461551910.220075
 ARGENTINA                 |   1996 | 467144722.521932
 ARGENTINA                 |   1995 | 468222825.362176
 ARGENTINA                 |   1994 | 464993519.543598
 ARGENTINA                 |   1993 |   461785186.2161
 ARGENTINA                 |   1992 | 464253638.614171
 BRAZIL                    |   1998 | 274435637.885116
 BRAZIL                    |   1997 | 467088239.824318
 BRAZIL                    |   1996 | 475136708.085229
 BRAZIL                    |   1995 | 464277564.017904
 BRAZIL                    |   1994 | 467231782.877047
 BRAZIL                    |   1993 |  469629061.32724
 BRAZIL                    |   1992 | 472439640.536394
 CANADA                    |   1998 | 267863523.187201
 CANADA                    |   1997 | 468455442.366323
 CANADA                    |   1996 | 474802928.814451
 CANADA                    |   1995 | 465346225.570261
 CANADA                    |   1994 | 472668151.002484
 CANADA                    |   1993 | 470036003.480362
 CANADA                    |   1992 | 461147545.215355
 CHINA                     |   1998 | 273908051.835461
 CHINA                     |   1997 | 460609695.837926
 CHINA                     |   1996 | 462672332.933538
 CHINA                     |   1995 | 461986846.603711
 CHINA                     |   1994 | 463952866.494916
 CHINA                     |   1993 | 457100563.751303
 CHINA                     |   1992 | 464805117.219201
 EGYPT                     |   1998 | 266805876.932445
 EGYPT                     |   1997 | 463934311.679669
 EGYPT                     |   1996 | 460612800.704529
 EGYPT                     |   1995 | 454824283.794362
 EGYPT                     |   1994 | 452589278.823559
 EGYPT                     |   1993 | 461377160.013238
 EGYPT                     |   1992 | 453256890.442405
 ETHIOPIA                  |   1998 | 265090816.575459
 ETHIOPIA                  |   1997 | 446676309.829413
 ETHIOPIA                  |   1996 | 458609585.745375
 ETHIOPIA                  |   1995 | 450486157.263627
 ETHIOPIA                  |   1994 | 457000133.295264
 ETHIOPIA                  |   1993 | 459021076.340057
 ETHIOPIA                  |   1992 | 462165629.744148
 FRANCE                    |   1998 | 270248578.909232
 FRANCE                    |   1997 | 454904164.846765
 FRANCE                    |   1996 | 460838186.268388
 FRANCE                    |   1995 | 451452765.876589
 FRANCE                    |   1994 | 456749353.004533
 FRANCE                    |   1993 |  455437474.40333
 FRANCE                    |   1992 | 457080490.456607
 GERMANY                   |   1998 | 276142122.398864
 GERMANY                   |   1997 | 468745422.601434
 GERMANY                   |   1996 | 473922209.599399
 GERMANY                   |   1995 | 468519097.485572
 GERMANY                   |   1994 | 473969193.405745
 GERMANY                   |   1993 | 480956196.638647
 GERMANY                   |   1992 | 473219397.520813
 INDIA                     |   1998 | 269777285.296892
 INDIA                     |   1997 | 466906483.780251
 INDIA                     |   1996 | 466253142.713803
 INDIA                     |   1995 | 470447805.843703
 INDIA                     |   1994 | 465936905.322084
 INDIA                     |   1993 | 471451322.214139
 INDIA                     |   1992 | 468461566.612327
 INDONESIA                 |   1998 | 270088283.070431
 INDONESIA                 |   1997 | 454299393.377453
 INDONESIA                 |   1996 | 455939882.622284
 INDONESIA                 |   1995 | 454503643.805731
 INDONESIA                 |   1994 | 451890080.551159
 INDONESIA                 |   1993 | 457508744.174282
 INDONESIA                 |   1992 | 462703779.165941
 IRAN                      |   1998 | 275611509.276535
 IRAN                      |   1997 | 469459671.772533
 IRAN                      |   1996 | 472121964.565404
 IRAN                      |   1995 | 468483902.246909
 IRAN                      |   1994 | 464999984.840236
 IRAN                      |   1993 | 465554448.222313
 IRAN                      |   1992 | 469426447.117548
 IRAQ                      |   1998 | 276425043.578721
 IRAQ                      |   1997 | 470810151.124951
 IRAQ                      |   1996 | 485491398.739425
 IRAQ                      |   1995 | 469166019.215715
 IRAQ                      |   1994 | 475071993.706781
 IRAQ                      |   1993 | 476997835.509127
 IRAQ                      |   1992 | 479263406.034969
 JAPAN                     |   1998 |  272417725.46901
 JAPAN                     |   1997 | 466936258.331212
 JAPAN                     |   1996 | 460235509.034251
 JAPAN                     |   1995 |  460805961.37363
 JAPAN                     |   1994 | 462438607.270329
 JAPAN                     |   1993 | 467413458.766129
 JAPAN                     |   1992 | 454453612.210837
 JORDAN                    |   1998 | 267794600.669107
 JORDAN                    |   1997 | 443892335.716122
 JORDAN                    |   1996 | 449494285.686409
 JORDAN                    |   1995 | 443641064.034301
 JORDAN                    |   1994 | 459156032.301031
 JORDAN                    |   1993 | 458664374.321957
 JORDAN                    |   1992 | 448818256.784241
 KENYA                     |   1998 | 272654190.161512
 KENYA                     |   1997 | 467043808.781618
 KENYA                     |   1996 | 466154019.252469
 KENYA                     |   1995 | 466849537.182048
 KENYA                     |   1994 | 470510951.255708
 KENYA                     |   1993 | 475231164.007041
 KENYA                     |   1992 | 473721085.646117
 MOROCCO                   |   1998 | 273334054.382987
 MOROCCO                   |   1997 | 462198070.755588
 MOROCCO                   |   1996 |  470642825.51949
 MOROCCO                   |   1995 | 467040296.799225
 MOROCCO                   |   1994 | 464136490.606803
 MOROCCO                   |   1993 | 467832710.170907
 MOROCCO                   |   1992 | 463035604.023531
 MOZAMBIQUE                |   1998 | 270744729.851479
 MOZAMBIQUE                |   1997 | 452468865.869299
 MOZAMBIQUE                |   1996 | 450692986.637162
 MOZAMBIQUE                |   1995 | 457522766.087945
 MOZAMBIQUE                |   1994 |   461159137.2663
 MOZAMBIQUE                |   1993 | 454887909.954726
 MOZAMBIQUE                |   1992 | 457281673.618592
 PERU                      |   1998 | 276516972.353795
 PERU                      |   1997 |  458329244.68589
 PERU                      |   1996 | 463162837.056255
 PERU                      |   1995 | 466298482.198966
 PERU                      |   1994 |  456124781.77259
 PERU                      |   1993 |    462050073.899
 PERU                      |   1992 | 470309461.086907
 ROMANIA                   |   1998 | 274364206.956549
 ROMANIA                   |   1997 | 459956194.609467
 ROMANIA                   |   1996 | 464623047.304605
 ROMANIA                   |   1995 | 448716701.121479
 ROMANIA                   |   1994 | 456699094.823448
 ROMANIA                   |   1993 | 462324159.394647
 ROMANIA                   |   1992 |  472902628.07423
 RUSSIA                    |   1998 | 270550719.138774
 RUSSIA                    |   1997 | 460944531.683526
 RUSSIA                    |   1996 | 464368500.941291
 RUSSIA                    |   1995 | 463245810.156979
 RUSSIA                    |   1994 | 450969824.567738
 RUSSIA                    |   1993 | 460396458.898817
 RUSSIA                    |   1992 | 471976246.754947
 SAUDI ARABIA              |   1998 | 272826653.141083
 SAUDI ARABIA              |   1997 | 463648666.641815
 SAUDI ARABIA              |   1996 | 460188048.555978
 SAUDI ARABIA              |   1995 | 464891028.786945
 SAUDI ARABIA              |   1994 | 464110214.878301
 SAUDI ARABIA              |   1993 | 457731656.906859
 SAUDI ARABIA              |   1992 | 457565084.478818
 UNITED KINGDOM            |   1998 | 267034009.183631
 UNITED KINGDOM            |   1997 | 462729101.437305
 UNITED KINGDOM            |   1996 | 458788297.502409
 UNITED KINGDOM            |   1995 | 454517158.413859
 UNITED KINGDOM            |   1994 | 463827851.564951
 UNITED KINGDOM            |   1993 | 465888769.687062
 UNITED KINGDOM            |   1992 | 459921038.521022
 UNITED STATES             |   1998 | 271895195.661773
 UNITED STATES             |   1997 | 475636191.233574
 UNITED STATES             |   1996 | 470146056.066207
 UNITED STATES             |   1995 | 469926967.365389
 UNITED STATES             |   1994 | 473068413.715694
 UNITED STATES             |   1993 |  463750329.60709
 UNITED STATES             |   1992 | 470995343.944768
 VIETNAM                   |   1998 | 271752870.421611
 VIETNAM                   |   1997 | 463720260.174799
 VIETNAM                   |   1996 |  472048880.34892
 VIETNAM                   |   1995 | 461069137.691792
 VIETNAM                   |   1994 | 465774569.788213
 VIETNAM                   |   1993 |  470414147.95948
 VIETNAM                   |   1992 |  467099523.24246
(175 rows)

COMMIT;
COMMIT
